---
title: 'Claude Agent SDK (Python) å­¦ç¿’ã‚¬ã‚¤ãƒ‰'
pubDate: 2025-10-17T00:00:00.000Z
description: 'Claude Agent SDKã®å®Œå…¨ã‚¬ã‚¤ãƒ‰ã€‚ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã‚¯ã‚¨ãƒªã€ã‚«ã‚¹ã‚¿ãƒ MCPãƒ„ãƒ¼ãƒ«æ‹¡å¼µã€è‡ªå‹•åŒ–ã®ãŸã‚ã®Hookã‚·ã‚¹ãƒ†ãƒ ã€ãƒ‡ãƒãƒƒã‚°ã€å®Ÿè£…ã‚’ç¶²ç¾…ã—ã¦ã„ã¾ã™ã€‚'
author: 'Remy'
tags: ['claude code', 'vibe coding', 'python']
lang: 'ja'
---

# Claude Agent SDK (Python) å­¦ç¿’ã‚¬ã‚¤ãƒ‰

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**ç”Ÿæˆæ—¥**: 2025-10-15
**SDKãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 0.1.3
**ãƒ¬ãƒ™ãƒ«**: æ¨™æº–ï¼ˆæ¨å®šå­¦ç¿’æ™‚é–“ï¼š2ã€œ4æ™‚é–“ï¼‰
**å¯¾è±¡èª­è€…**: ä¸­ç´šPythoné–‹ç™ºè€…

---

## ç›®æ¬¡

1. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](#-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦)
2. [ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆ15åˆ†ï¼‰](#-ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ15åˆ†)
3. [ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆï¼ˆ20åˆ†ï¼‰](#-ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆ20åˆ†)
4. [ä¸»ãªæ©Ÿèƒ½ï¼ˆ30åˆ†ï¼‰](#-ä¸»ãªæ©Ÿèƒ½30åˆ†)
5. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆï¼ˆ20åˆ†ï¼‰](#-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ20åˆ†)
6. [å®Ÿè·µä¾‹ï¼ˆ30åˆ†ï¼‰](#-å®Ÿè·µä¾‹30åˆ†)
7. [å­¦ç¿’ãƒ‘ã‚¹ã®æ¨å¥¨](#å­¦ç¿’ãƒ‘ã‚¹ã®æ¨å¥¨)
8. [FAQ & ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#faq--ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
9. [å‚è€ƒæ–‡çŒ®](#å‚è€ƒæ–‡çŒ®)
10. [ä»˜éŒ²](#ä»˜éŒ²)

---

## ğŸ“– ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç´¹ä»‹

**Claude Agent SDK for Python**ã¯ã€AnthropicãŒæä¾›ã™ã‚‹Claude Codeã¨ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ çš„ãªå¯¾è©±ã®ãŸã‚ã®å…¬å¼Python SDKã§ã™ã€‚Claude Code CLIã‚’ãƒ©ãƒƒãƒ—ã—ã€ç°¡æ½”ã§Pythonã‚‰ã—ã„APIã‚’æä¾›ã—ã€ä»¥ä¸‹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ï¼š

- **åŒæ–¹å‘ä¼šè©±**: Claudeã¨ã®ãƒãƒ«ãƒã‚¿ãƒ¼ãƒ³ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒ£ãƒƒãƒˆ
- **ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«**: ãƒ—ãƒ­ã‚»ã‚¹å†…MCPã‚µãƒ¼ãƒãƒ¼ã‚’é€šã˜ã¦Claudeã®æ©Ÿèƒ½ã‚’æ‹¡å¼µ
- **Hookã‚·ã‚¹ãƒ†ãƒ **: ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œå‰å¾Œã«ã‚«ã‚¹ã‚¿ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒ¿å…¥
- **æ¨©é™åˆ¶å¾¡**: ãã‚ç´°ã‹ã„ãƒ„ãƒ¼ãƒ«ä½¿ç”¨æ¨©é™
- **éåŒæœŸå„ªå…ˆ**: `anyio`ã«åŸºã¥ãã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ éåŒæœŸã‚µãƒãƒ¼ãƒˆ

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¤ãƒ—**: SDK / é–‹ç™ºè€…ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
**è¨€èª**: Python 3.10+
**ãƒ©ã‚¤ã‚»ãƒ³ã‚¹**: MIT
**ãƒªãƒã‚¸ãƒˆãƒª**: https://github.com/anthropics/claude-agent-sdk-python

### 1.2 ã‚³ã‚¢æ©Ÿèƒ½

1. **2ã¤ã®ä½¿ç”¨ãƒ¢ãƒ¼ãƒ‰**
   - `query()`: ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ãªã‚·ãƒŠãƒªã‚ªç”¨ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¯ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚¯ã‚¨ãƒª
   - `ClaudeSDKClient`: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ãªä¼šè©±

2. **ãƒ—ãƒ­ã‚»ã‚¹å†…MCPãƒ„ãƒ¼ãƒ«**
   - `@tool`ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«ã‚’ç´ æ—©ãå®šç¾©
   - åˆ¥ãƒ—ãƒ­ã‚»ã‚¹ä¸è¦â€”å¤–éƒ¨MCPã‚µãƒ¼ãƒãƒ¼ã‚ˆã‚Šé«˜é€Ÿ
   - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã¨å¤‰æ•°ã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹

3. **å¼·åŠ›ãªåˆ¶å¾¡**
   - Hookã‚·ã‚¹ãƒ†ãƒ ï¼šPreToolUseã€PostToolUseãªã©ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯
   - æ¨©é™ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼šå‹•çš„ãªãƒ„ãƒ¼ãƒ«ä½¿ç”¨æ±ºå®š
   - ä¸­æ–­ã‚µãƒãƒ¼ãƒˆï¼šé•·æ™‚é–“å®Ÿè¡Œã‚¿ã‚¹ã‚¯ã‚’ã„ã¤ã§ã‚‚åœæ­¢

4. **å‹å®‰å…¨**
   - å®Œå…¨ãªå‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆmypyäº’æ›ï¼‰
   - å¼·ãå‹ä»˜ã‘ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ–ãƒ­ãƒƒã‚¯
   - IDEã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã¨å‹ãƒã‚§ãƒƒã‚¯

5. **éåŒæœŸè¨­è¨ˆ**
   - `anyio`ã«åŸºã¥ãï¼›asyncioã¨trioã‚’ã‚µãƒãƒ¼ãƒˆ
   - ä½ãƒ¡ãƒ¢ãƒªãƒ•ãƒƒãƒˆãƒ—ãƒªãƒ³ãƒˆã®ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†
   - åŒæ™‚ã‚¿ã‚¹ã‚¯ç®¡ç†

### 1.3 SDKã‚’ä½¿ç”¨ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°

**é©ã—ãŸã‚±ãƒ¼ã‚¹**:
- ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚„ä¼šè©±å‹UIã®æ§‹ç¯‰
- ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã¨åˆ†æãƒ„ãƒ¼ãƒ«ã®è‡ªå‹•åŒ–
- Claudeã‚’æ—¢å­˜ã®Pythonã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«çµ±åˆ
- ã‚«ã‚¹ã‚¿ãƒ é–‹ç™ºã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚„CI/CDãƒ„ãƒ¼ãƒ«ã®ä½œæˆ
- ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«ã¨æ¨©é™åˆ¶å¾¡ã‚’å¿…è¦ã¨ã™ã‚‹ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚¢ãƒ—ãƒª

**é©ã•ãªã„ã‚±ãƒ¼ã‚¹**:
- ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¯ãƒ³ã‚ªãƒ•ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆCLIã‚’ç›´æ¥ä½¿ç”¨ï¼‰
- Pythonä»¥å¤–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆä»–è¨€èªã®SDKã‚’ä½¿ç”¨ï¼‰
- ãƒ—ãƒ­ã‚°ãƒ©ãƒ çš„ãªå¯¾è©±ä»¥å¤–ï¼ˆClaude Code GUIã‚’ä½¿ç”¨ï¼‰

### 1.4 å­¦ç¿’ç›®æ¨™

ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

âœ… SDKã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹
âœ… `query()`ã¨`ClaudeSDKClient`ã§åŸºæœ¬çš„ãŠã‚ˆã³é«˜åº¦ãªã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹
âœ… Claudeã®æ©Ÿèƒ½ã‚’æ‹¡å¼µã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ MCPãƒ„ãƒ¼ãƒ«ã‚’ä½œæˆã™ã‚‹
âœ… Hookã‚·ã‚¹ãƒ†ãƒ ã§å‹•ä½œã‚’è‡ªå‹•åŒ–ãƒ»åˆ¶å¾¡ã™ã‚‹
âœ… ä¸€èˆ¬çš„ãªå•é¡Œã‚’ãƒ‡ãƒãƒƒã‚°ãƒ»è§£æ±ºã™ã‚‹
âœ… æœ¬ç•ªå“è³ªã®Claudeçµ±åˆã‚’è¨­è¨ˆãƒ»å®Ÿè£…ã™ã‚‹

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆ15åˆ†ï¼‰

### 2.1 å‰ææ¡ä»¶

#### å¿…è¦ãªçŸ¥è­˜
- **PythonåŸºç¤ï¼ˆ3.10+ï¼‰**: ãƒ‡ãƒ¼ã‚¿å‹ã€ã‚¯ãƒ©ã‚¹ã€ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã€éåŒæœŸ
- **éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°**: `async`/`await`ã€éåŒæœŸã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼ã€åŸºæœ¬çš„ãª`anyio`
- **å‹ãƒ’ãƒ³ãƒˆ**: `typing`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€TypedDictã€Literal

#### æ¨å¥¨çŸ¥è­˜
- **ãƒ—ãƒ­ã‚»ã‚¹é–“é€šä¿¡**: stdin/stdout/stderrã€ã‚µãƒ–ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†
- **JSON**: ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º / ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º
- **MCPãƒ—ãƒ­ãƒˆã‚³ãƒ«**: Model Context Protocolã®åŸºç¤ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### 2.2 ç’°å¢ƒè¨­å®š

#### ã‚¹ãƒ†ãƒƒãƒ—1: Pythonãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèª

```bash
python --version
# 3.10ä»¥ä¸ŠãŒå¿…è¦
```

ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä½ã„å ´åˆã€ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ï¼š

```bash
# Ubuntu/Debian
sudo apt install python3.10

# macOS
brew install python@3.10

# Windows: https://python.org/downloads/ ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: Claude Code CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

CLIã¯å¿…é ˆã®ä¾å­˜é–¢ä¿‚ã§ã™ã€‚

```bash
# Claude Code CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install -g @anthropic-ai/claude-code

# ç¢ºèª
claude -v
# 2.0.0ä»¥ä¸ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãš
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: APIã‚­ãƒ¼ã‚’è¨­å®š

```bash
# Linux/macOS
export ANTHROPIC_API_KEY="sk-ant-api03-your-key-here"

# Windows (PowerShell)
$env:ANTHROPIC_API_KEY = "sk-ant-api03-your-key-here"

# æ°¸ç¶šçš„ï¼ˆLinux/macOSï¼‰
echo 'export ANTHROPIC_API_KEY="sk-ant-api03-..."' >> ~/.bashrc
source ~/.bashrc
```

ã‚­ãƒ¼ã¯ https://console.anthropic.com/ ã§å–å¾—ã§ãã¾ã™ã€‚

#### ã‚¹ãƒ†ãƒƒãƒ—4: SDKã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: PyPIã‹ã‚‰ï¼ˆæ¨å¥¨ï¼‰
pip install claude-agent-sdk

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: ã‚½ãƒ¼ã‚¹ã‹ã‚‰ï¼ˆé–‹ç™ºç”¨ï¼‰
cd claude-agent-sdk-python
pip install -e .
```

#### ã‚¹ãƒ†ãƒƒãƒ—5: ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ç¢ºèª

```bash
python -c "import claude_agent_sdk; print(claude_agent_sdk.__version__)"
# ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãš: 0.1.3
```

### 2.3 æœ€åˆã®ä¾‹

`hello_claude.py`ã‚’ä½œæˆï¼š

```python
#!/usr/bin/env python3
"""æœ€åˆã®Claude Agent SDKã®ä¾‹"""

import anyio
from claude_agent_sdk import query, AssistantMessage, TextBlock

async def main():
    """ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¯ã‚¨ãƒªã®ä¾‹"""
    print("Claudeã«è³ªå•ã—ã¦ã„ã¾ã™...")

    async for message in query(prompt="2 + 2ã¯ï¼Ÿ"):
        if isinstance(message, AssistantMessage):
            for block in message.content:
                if isinstance(block, TextBlock):
                    print(f"Claude: {block.text}")

if __name__ == "__main__":
    anyio.run(main)
```

å®Ÿè¡Œï¼š

```bash
python hello_claude.py
```

æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼š

```
Claudeã«è³ªå•ã—ã¦ã„ã¾ã™...
Claude: 2 + 2 ã¯ 4 ã§ã™ã€‚
```

### 2.4 æ¤œè¨¼

ä¾‹ãŒæ­£å¸¸ã«å®Ÿè¡Œã§ãã‚Œã°æº–å‚™å®Œäº†ã§ã™ï¼

ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚ŒãŸå ´åˆï¼š

- `CLINotFoundError`: CLIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- `ImportError`: SDKãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- `ProcessError`: APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

è©³ç´°ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯[FAQ](#faq--ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ“š ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆï¼ˆ20åˆ†ï¼‰

### 3.1 ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

å­¦ç¿’ã®å„ªå…ˆé †ä½é †ï¼š

1. **Claude Code CLI** â­â­â­â­â­ â€“ åŸºç›¤å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³
2. **Claude Agent SDK** â­â­â­â­â­ â€“ Pythonãƒ©ãƒƒãƒ‘ãƒ¼ãƒ¬ã‚¤ãƒ¤ãƒ¼
3. **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—** â­â­â­â­â­ â€“ ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
4. **ãƒ„ãƒ¼ãƒ«** â­â­â­â­â­ â€“ ãƒ„ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ 
5. **MCP** â­â­â­â­ â€“ Model Context Protocol
6. **Hooks** â­â­â­â­ â€“ ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯
7. **æ¨©é™ã‚·ã‚¹ãƒ†ãƒ ** â­â­â­â­ â€“ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ¶å¾¡
8. **anyio** â­â­â­â­ â€“ éåŒæœŸãƒ©ã‚¤ãƒ–ãƒ©ãƒª
9. **ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ** â­â­â­ â€“ ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆæŠ½è±¡åŒ–
10. **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©** â­â­â­ â€“ ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

### 3.2 ã‚³ãƒ³ã‚»ãƒ—ãƒˆè©³ç´°è§£èª¬

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ1: Claude Code CLI

**å®šç¾©**: Anthropicã®å…¬å¼CLIã§ã€Claude AIã¸ã®ä½ãƒ¬ãƒ™ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã€‚

**å½¹å‰²**: SDKã¯CLIã‚’ã‚µãƒ–ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦èµ·å‹•ã—ï¼›CLIã¯Anthropic APIã¨é€šä¿¡ã€‚

**ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**: `npm install -g @anthropic-ai/claude-code`

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ**:
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¦ä»¶: â‰¥ 2.0.0
- JSONLã‚’ä½¿ç”¨ã—ã¦stdin/stdoutã§é€šä¿¡
- ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆï¼ˆåŒæ–¹å‘ï¼‰

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ2: Claude Agent SDK

**å®šç¾©**: CLIã‚’ãƒ©ãƒƒãƒ—ã—ã€Pythonã‚‰ã—ã„APIã‚’å…¬é–‹ã™ã‚‹Python SDKã€‚

**2ã¤ã®ä½¿ç”¨ãƒ¢ãƒ¼ãƒ‰**:
- `query()`: ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ã€ãƒ¯ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚¯ã‚¨ãƒª
- `ClaudeSDKClient`: ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³

**ã‚³ã‚¢ãƒ¡ãƒªãƒƒãƒˆ**:
- ç°¡ç´ åŒ–ã•ã‚ŒãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- å‹å®‰å…¨æ€§
- ãƒ—ãƒ­ã‚»ã‚¹å†…MCPãƒ„ãƒ¼ãƒ«
- ãƒ•ãƒƒã‚¯ã¨æ¨©é™åˆ¶å¾¡

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ3: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—

**å®šç¾©**: SDKå†…ã®æ§˜ã€…ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ§‹é€ ã€‚

**ä¸»ãªã‚¿ã‚¤ãƒ—**:
- `UserMessage`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- `AssistantMessage`: Claudeã®å¿œç­”
- `SystemMessage`: ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- `ResultMessage`: çµæœã¨ã‚³ã‚¹ãƒˆæƒ…å ±
- `StreamEvent`: ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚¤ãƒ™ãƒ³ãƒˆ

**ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ–ãƒ­ãƒƒã‚¯ã‚¿ã‚¤ãƒ—**:
- `TextBlock`: ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
- `ThinkingBlock`: æ¨è«–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
- `ToolUseBlock`: ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—
- `ToolResultBlock`: ãƒ„ãƒ¼ãƒ«çµæœ

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ4: ãƒ„ãƒ¼ãƒ«

**å®šç¾©**: ClaudeãŒã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«å‘¼ã³å‡ºã›ã‚‹é–¢æ•°ã€‚

**2ç¨®é¡**:
- **çµ„ã¿è¾¼ã¿**: Readã€Writeã€Bashã€Editã€Globã€Grepãªã©
- **ã‚«ã‚¹ã‚¿ãƒ **: `@tool`ã§å®šç¾©

**ä¾‹**:

```python
from claude_agent_sdk import tool

@tool("add", "2ã¤ã®æ•°ã‚’è¶³ã™", {"a": float, "b": float})
async def add_numbers(args):
    result = args["a"] + args["b"]
    return {
        "content": [{"type": "text", "text": f"çµæœ: {result}"}]
    }
```

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ5: MCP (Model Context Protocol)

**å®šç¾©**: ãƒ„ãƒ¼ãƒ«ãŒAIãƒ¢ãƒ‡ãƒ«ã¨ã©ã®ã‚ˆã†ã«é€šä¿¡ã™ã‚‹ã‹ã‚’å®šç¾©ã™ã‚‹æ¨™æº–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚

**SDKå®Ÿè£…**:
- **SDK MCP Server**ï¼ˆãƒ—ãƒ­ã‚»ã‚¹å†…ï¼‰: `create_sdk_mcp_server()`ã§ä½œæˆ
- **å¤–éƒ¨MCP Server**ï¼ˆå¤–éƒ¨ãƒ—ãƒ­ã‚»ã‚¹ï¼‰: stdio/SSE/HTTPã§é€šä¿¡

**ãƒ¡ãƒªãƒƒãƒˆ**:
- æ¨™æº–åŒ–ã•ã‚ŒãŸãƒ„ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- è¤‡æ•°ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³
- æ‹¡å¼µå¯èƒ½

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ6: Hooks

**å®šç¾©**: Claudeã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã®ç‰¹å®šã®ãƒã‚¤ãƒ³ãƒˆã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€‚

**ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ**:
- `PreToolUse`: ãƒ„ãƒ¼ãƒ«ä½¿ç”¨å‰ï¼ˆæ¨©é™åˆ¶å¾¡ï¼‰
- `PostToolUse`: ãƒ„ãƒ¼ãƒ«ä½¿ç”¨å¾Œï¼ˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè¿½åŠ ï¼‰
- `UserPromptSubmit`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé€ä¿¡å¾Œ
- `Stop`: åœæ­¢ã‚¤ãƒ™ãƒ³ãƒˆ
- `SubagentStop`: ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåœæ­¢
- `PreCompact`: åœ§ç¸®å‰

**ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**:
- ãƒ­ã‚°è¨˜éŒ²
- å‹•çš„æ¨©é™åˆ¶å¾¡
- ãƒ„ãƒ¼ãƒ«å‹•ä½œã®å¤‰æ›´
- ç›£æŸ»ãƒ»ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ7: æ¨©é™ã‚·ã‚¹ãƒ†ãƒ 

**å®šç¾©**: ClaudeãŒå®Ÿè¡Œã§ãã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’åˆ¶å¾¡ã€‚

**æ¨©é™ãƒ¢ãƒ¼ãƒ‰**:
- `default`: CLIãŒå±é™ºãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
- `acceptEdits`: ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†ã‚’è‡ªå‹•æ‰¿èª
- `plan`: è¨ˆç”»ãƒ¢ãƒ¼ãƒ‰â€”ãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè¡Œã—ãªã„
- `bypassPermissions`: ã™ã¹ã¦ã®æ¨©é™ãƒã‚§ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆå±é™ºï¼ï¼‰

**æ¨©é™ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯**:

```python
async def permission_callback(tool_name, input_data, context):
    if tool_name == "Bash" and "rm -rf" in input_data.get("command", ""):
        return PermissionResultDeny(message="å±é™ºãªã‚³ãƒãƒ³ãƒ‰")
    return PermissionResultAllow()
```

#### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ8: anyio

**å®šç¾©**: asyncioã¨trio APIã‚’çµ±ä¸€ã™ã‚‹ã‚¯ãƒ­ã‚¹ãƒ©ãƒ³ã‚¿ã‚¤ãƒ éåŒæœŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚

**ä½¿ç”¨ã™ã‚‹ç†ç”±**:
- çµ±ä¸€ã•ã‚ŒãŸéåŒæœŸAPI
- è¤‡æ•°ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ã‚µãƒãƒ¼ãƒˆ
- ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ç°¡ç´ åŒ–

**åŸºæœ¬çš„ãªä½¿ç”¨**:

```python
import anyio

async def main():
    await anyio.sleep(1)
    async with anyio.create_task_group() as tg:
        tg.start_soon(task1)
        tg.start_soon(task2)

anyio.run(main)
```

### 3.3 ã‚³ãƒ³ã‚»ãƒ—ãƒˆãƒãƒƒãƒ—

```
å¤–éƒ¨ä¾å­˜é–¢ä¿‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node.js â†’ Claude Code CLI (â‰¥2.0.0)      â”‚
â”‚ Python 3.10+ â†’ anyio â†’ mcp              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ¬ã‚¤ãƒ¤ãƒ¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MCP (Model Context Protocol)            â”‚
â”‚ SDK Control Protocol                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
SDKã‚³ã‚¢
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Claude Agent SDK                        â”‚
â”‚   â”œâ”€ query() [ã‚·ãƒ³ãƒ—ãƒ«ã‚¯ã‚¨ãƒª]           â”‚
â”‚   â””â”€ ClaudeSDKClient [ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
æ©Ÿèƒ½ãƒ¬ã‚¤ãƒ¤ãƒ¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tools | Permissions | Hooks              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ã‚¤ãƒ¤ãƒ¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚ãªãŸã®Pythonã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 æ¨å¥¨å­¦ç¿’é †åº

```
ã‚¹ãƒ†ãƒƒãƒ—1: PythonåŸºç¤ + éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
  â†“
ã‚¹ãƒ†ãƒƒãƒ—2: Claude Code CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ä½¿ç”¨
  â†“
ã‚¹ãƒ†ãƒƒãƒ—3: Claude Agent SDKã®åŸºç¤ï¼ˆqueryé–¢æ•°ï¼‰
  â†“
ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ–ãƒ­ãƒƒã‚¯
  â†“
ã‚¹ãƒ†ãƒƒãƒ—5: MCPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ãƒ„ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ 
  â†“
ã‚¹ãƒ†ãƒƒãƒ—6: ClaudeSDKClientã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³
  â†“
ã‚¹ãƒ†ãƒƒãƒ—7: æ¨©é™ã‚·ã‚¹ãƒ†ãƒ 
  â†“
ã‚¹ãƒ†ãƒƒãƒ—8: Hooks
```

---

## ğŸ”§ ä¸»ãªæ©Ÿèƒ½ï¼ˆ30åˆ†ï¼‰

### 4.1 APIæ¦‚è¦

SDKã¯2ã¤ã®ä¸»è¦ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å…¬é–‹ã—ã¾ã™ï¼š

| API | ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ | ç‰¹å¾´ |
|-----|----------|-----------------|
| `query()` | ã‚·ãƒ³ãƒ—ãƒ«ã‚¯ã‚¨ãƒªã€ãƒãƒƒãƒã‚¸ãƒ§ãƒ– | ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¸€æ–¹å‘ |
| `ClaudeSDKClient` | ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã€ãƒãƒ«ãƒã‚¿ãƒ¼ãƒ³ãƒãƒ£ãƒƒãƒˆ | ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°åŒæ–¹å‘ |

### 4.2 ä½¿ç”¨ãƒ¢ãƒ¼ãƒ‰

#### ãƒ¢ãƒ¼ãƒ‰1: `query()` é–¢æ•°

**ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**: ãƒ¯ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚¯ã‚¨ãƒªã¾ãŸã¯ãƒãƒƒãƒã‚¿ã‚¹ã‚¯ã€‚

**åŸºæœ¬çš„ãªä½¿ç”¨**:

```python
from claude_agent_sdk import query

async for message in query(prompt="2 + 2ã¯ï¼Ÿ"):
    print(message)
```

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã‚¯ã‚¨ãƒª**:

```python
from claude_agent_sdk import query, ClaudeAgentOptions

options = ClaudeAgentOptions(
    system_prompt="ã‚ãªãŸã¯å½¹ã«ç«‹ã¤ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™",
    allowed_tools=["Read", "Write"],
    max_turns=5
)

async for message in query(prompt="hello.txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„", options=options):
    print(message)
```

**ç‰¹å¾´**:
- ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹â€”å„å‘¼ã³å‡ºã—ã¯ç‹¬ç«‹
- æ¥ç¶šãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’è‡ªå‹•ç®¡ç†
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨è‡ªå‹•åŒ–ã«æœ€é©

#### ãƒ¢ãƒ¼ãƒ‰2: `ClaudeSDKClient` ã‚¯ãƒ©ã‚¹

**ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**: ãƒãƒ«ãƒã‚¿ãƒ¼ãƒ³ä¼šè©±ã€ä¸­æ–­åˆ¶å¾¡ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒ—ãƒªã€‚

**åŸºæœ¬çš„ãªä½¿ç”¨**:

```python
from claude_agent_sdk import ClaudeSDKClient

async with ClaudeSDKClient() as client:
    # ã‚¿ãƒ¼ãƒ³1
    await client.query("ãƒ•ãƒ©ãƒ³ã‚¹ã®é¦–éƒ½ã¯ï¼Ÿ")
    async for msg in client.receive_response():
        print(msg)

    # ã‚¿ãƒ¼ãƒ³2ï¼ˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¿æŒï¼‰
    await client.query("ãã®äººå£ã¯ï¼Ÿ")
    async for msg in client.receive_response():
        print(msg)
```

**ã‚³ã‚¢ãƒ¡ã‚½ãƒƒãƒ‰**:
- `connect()`: æ¥ç¶šã‚’ç¢ºç«‹
- `query(prompt)`: ã‚¯ã‚¨ãƒªã‚’é€ä¿¡
- `receive_messages()`: ã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡
- `receive_response()`: 1ã¤ã®å®Œå…¨ãªå¿œç­”ã‚’å—ä¿¡
- `interrupt()`: ä¸­æ–­ã‚’é€ä¿¡
- `set_permission_mode(mode)`: æ¨©é™ãƒ¢ãƒ¼ãƒ‰ã‚’å¤‰æ›´
- `disconnect()`: æ¥ç¶šã‚’é–‰ã˜ã‚‹

**ç‰¹å¾´**:
- ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«â€”ä¼šè©±ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç¶­æŒ
- ä¸­æ–­ã¨å‹•çš„è¨­å®šã‚’ã‚µãƒãƒ¼ãƒˆ
- ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–UIã«æœ€é©

### 4.3 è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³

#### å…±é€šã®`ClaudeAgentOptions`

```python
from claude_agent_sdk import ClaudeAgentOptions

options = ClaudeAgentOptions(
    # ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    system_prompt="ã‚ãªãŸã¯å½¹ã«ç«‹ã¤ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™",

    # ãƒ„ãƒ¼ãƒ«æ¨©é™
    allowed_tools=["Read", "Write", "Bash"],
    disallowed_tools=["Edit"],

    # æ¨©é™ãƒ¢ãƒ¼ãƒ‰
    permission_mode="default",  # ã¾ãŸã¯ "acceptEdits", "plan", "bypassPermissions"

    # ä¼šè©±åˆ¶é™
    max_turns=10,

    # ãƒ¢ãƒ‡ãƒ«
    model="claude-sonnet-4-5",

    # ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
    cwd="/path/to/project",

    # MCPã‚µãƒ¼ãƒãƒ¼
    mcp_servers={
        "my-server": {...}
    },

    # ãƒ„ãƒ¼ãƒ«æ¨©é™ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
    can_use_tool=my_permission_callback,

    # Hooks
    hooks={
        "PreToolUse": [HookMatcher(...)],
        "PostToolUse": [HookMatcher(...)]
    },

    # ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
    include_partial_messages=True
)
```

### 4.4 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—

#### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—éšå±¤

```python
Message = UserMessage | AssistantMessage | SystemMessage | ResultMessage | StreamEvent
```

#### UserMessage

```python
from claude_agent_sdk import UserMessage

# ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
user_msg = UserMessage(
    content="ã“ã‚“ã«ã¡ã¯Claude",
    parent_tool_use_id=None
)

# ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ–ãƒ­ãƒƒã‚¯ã®ãƒªã‚¹ãƒˆ
user_msg = UserMessage(
    content=[
        {"type": "text", "text": "ã“ã‚“ã«ã¡ã¯"},
        {"type": "image", "source": {...}}
    ],
    parent_tool_use_id=None
)
```

#### AssistantMessage

```python
from claude_agent_sdk import AssistantMessage, TextBlock, ToolUseBlock

for message in messages:
    if isinstance(message, AssistantMessage):
        for block in message.content:
            if isinstance(block, TextBlock):
                print(f"ãƒ†ã‚­ã‚¹ãƒˆ: {block.text}")
            elif isinstance(block, ToolUseBlock):
                print(f"ãƒ„ãƒ¼ãƒ«: {block.name}, å…¥åŠ›: {block.input}")
```

#### ResultMessage

```python
from claude_agent_sdk import ResultMessage

if isinstance(message, ResultMessage):
    print(f"æœŸé–“: {message.duration_ms} ms")
    print(f"ã‚³ã‚¹ãƒˆ: ${message.total_cost_usd}")
    print(f"ã‚¿ãƒ¼ãƒ³æ•°: {message.num_turns}")
    print(f"ã‚¨ãƒ©ãƒ¼: {message.is_error}")
```

### 4.5 ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«

#### SDK MCPã‚µãƒ¼ãƒãƒ¼ã®ä½œæˆ

```python
from claude_agent_sdk import tool, create_sdk_mcp_server, ClaudeAgentOptions

# 1. ãƒ„ãƒ¼ãƒ«ã‚’å®šç¾©
@tool("calculate_sum", "2ã¤ã®æ•°ã‚’è¶³ã™", {"a": float, "b": float})
async def calculate_sum(args):
    result = args["a"] + args["b"]
    return {
        "content": [{"type": "text", "text": f"åˆè¨ˆ: {result}"}]
    }

# 2. ã‚µãƒ¼ãƒãƒ¼ã‚’ä½œæˆ
server = create_sdk_mcp_server(
    name="math-tools",
    version="1.0.0",
    tools=[calculate_sum]
)

# 3. è¨­å®š
options = ClaudeAgentOptions(
    mcp_servers={"math-tools": server}
)
```

---

ã“ã®ã‚¬ã‚¤ãƒ‰ã¯Claude Agent SDKã®ä¸»è¦ãªæ©Ÿèƒ½ã¨æ¦‚å¿µã‚’ç¶²ç¾…ã—ã¦ã„ã¾ã™ã€‚è©³ç´°ãªå®Ÿè£…ä¾‹ã‚„é«˜åº¦ãªãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ã¯ã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
